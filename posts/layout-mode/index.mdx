---
title: Layout Mode
excerpt: Layout mode æ˜¯ä¸€å€‹å¸¸è¢«äººå€‘å¿½ç•¥çš„ CSS æ¦‚å¿µï¼Œä½†çŸ¥é“å®ƒï¼Œä½ æ‰èƒ½çœŸæ­£ç­è§£ CSS å¥‡æ€ªä¹‹è™•èˆ‡ CSS tricks çš„ç™¼ç”ŸåŸå› ï¼ŒLayout mode å¸¶æˆ‘å€‘ä»¥æ­£ç¢ºçš„è§’åº¦ç†è§£ CSSã€‚
publish_date: 2022/1/9
category: mechanism
---

å¦‚æœä½ æƒ³æœ‰ä¸€å€‹æ­£ç¢ºçš„ CSS mental modelï¼Œé‚£éº¼ layout mode ä¸€å®šæ˜¯ä½ ä¸å¯æˆ–ç¼ºçš„æ¦‚å¿µã€‚

åœ¨é€™ç¯‡æ–‡ç« è£¡ï¼Œæˆ‘æœƒå…ˆä»‹ç´¹ layout mode æ˜¯ä»€éº¼ï¼Œæ¥è‘—ä»‹ç´¹å®ƒç‚ºä»€éº¼é‡è¦ä»¥åŠæ”¹è®Š layout mode çš„æ–¹æ³•ã€‚

## Layout Mode

layout modeï¼Œæœ‰æ™‚åˆç¨± layoutï¼Œæ˜¯ä¸€çµ„æ¼”ç®—æ³•ï¼Œå®ƒ**å®šç¾©äº† element çš„æ’åˆ—æ–¹å¼åŠè¡Œç‚º**ï¼Œåƒæ˜¯åœ¨ flexible box layout è£¡ï¼Œelements å¯ä»¥ä¾æ°´å¹³æˆ–å‚ç›´æ–¹å‘æ’åˆ—ï¼Œä¸¦ä¸”å¯ä»¥ç”¨ `justify-content` æˆ– `align-items` ç­‰å±¬æ€§æ§åˆ¶ element å¯¦éš›è©²åœ¨çš„ä½ç½®ã€‚

### Layout mode module

layout mode module æ˜¯å¦ä¸€å€‹å­˜åœ¨æ–¼ CSS è¦ç¯„ä¸­çš„ termï¼Œå®ƒä»£è¡¨äº†ä¸€å€‹æ–° layout åŠ ä¸Šå…¶æ‰€å¸¶ä¾†çš„æ–°å…§å®¹ï¼Œå¸¸è¦‹çš„ layout mode module æœ‰ positioned layout module, flexible box layout module, grid layout moduleï¼Œèˆ‰ flexible box layout module ç‚ºä¾‹ï¼Œé€™å€‹ module æ“´å……äº† `display` å±¬æ€§çš„å€¼ï¼š`flex`, `inline-flex` ä¸¦ä¸”æ·»åŠ æ•¸å€‹é—œéµå­—ï¼Œåƒæ˜¯ flex container, flex item, flex formatting context ç­‰ã€‚

åœ¨ç¾åœ¨ï¼ŒCSS ä¸­ç¸½å…±æœ‰ 7 ç¨®ä¸åŒçš„ layout modeï¼Œæˆ‘å€‘åº•ä¸‹ä¾†åˆ†åˆ¥ä»‹ç´¹ï¼š

### Flow Layout

flow layoutï¼Œåˆç¨± normal flowï¼Œæ˜¯é è¨­çš„ layoutï¼Œè‹¥ä½ æ²’æœ‰ç‰¹åˆ¥å®šç¾© layoutï¼Œé‚£éº¼æ•´ä»½ç¶²é å°±æœƒæ˜¯ flow layoutã€‚

åœ¨ flow layout è£¡ï¼Œblock level çš„ element æœƒåƒèˆ‡åˆ° block formatting contextï¼Œè€Œ inline level çš„ element å‰‡æœƒåƒèˆ‡åˆ° inline formatting contextï¼Œä¸”å…¶ä¸‹çš„ element éƒ½å¿…é ˆåƒèˆ‡ä¸€ç¨® formatting context (æ‰€ä»¥ä¸€å€‹ element ä¸æ˜¯ block å°±æ˜¯ inline)ã€‚

åœ¨ flow layout ä¸‹ï¼Œelement æ ¹æ“šå…¶æ‰€åœ¨çš„ formatting context (block or inline) ä¾†é€²è¡Œä¸åŒçš„æ’åˆ—ã€‚

### Float Layout

float layout ä¸‹çš„ element ä»¥ float çš„æ–¹å¼é€²è¡Œæ’åˆ—ã€‚

### Table Layout

table layout ä¸‹çš„ element ä»¥ table çš„æ–¹å¼é€²è¡Œæ’åˆ—ã€‚

### Positioned Layout

ä¾ç…§ `position` çš„ value ä»¥åŠ `top`, `bottom`, `left`, `right` ç­‰å±¬æ€§å° element é€²è¡Œå®šä½ã€‚

### Multi-column layout

multi-column layout ä¸‹çš„ element å¯ä»¥åƒ newspaper æˆ–æ›¸ç±é‚£æ¨£æ’åˆ—ã€‚

### Flexible box layout

flexible box layout ä¸‹çš„ element èƒ½é€é flex å±¬æ€§é€²è¡Œè¤‡é›œæ’åˆ—ã€‚

### Grid layout

grid layout ä¸‹çš„ element èƒ½é€é grid å±¬æ€§é€²è¡Œè¤‡é›œäºŒç¶­æ’åˆ—ã€‚

åœ¨é€™äº›ä¸åŒçš„ layout ä¸­é‚„å®šç¾©äº†è¨±å¤šç´°å‰‡ï¼Œåƒæ˜¯åœ¨ flexible box layout å®šç¾©äº† flex item é–“ä¸æœƒç™¼ç”Ÿ margin collapseã€‚

è€Œ layout èˆ‡ layout å½¼æ­¤ä¹‹é–“ä¹Ÿå­˜åœ¨è‘—ä¸€äº›äº’å‹•è¦å‰‡ï¼Œåƒæ˜¯ positioned layout element é è¨­æœƒæ¸²æŸ“åœ¨å…¶ä»–ç¨® layout element çš„ã€Œä¸Šæ–¹ã€(z è»¸)ã€‚

é€™äº› layout çš„è¦å‰‡å¤šä¸”ç¹é›œï¼Œä¸”å…§å®¹è¶…å‡ºæœ¬ç¯‡ä¸»é¡Œï¼Œåœ¨æœªä¾†å†å‘å¤§å®¶æ·±å…¥ä»‹ç´¹ã€‚

## Formatting Context

åœ¨ä¸Šå€‹æ®µè½ä¸­ï¼Œæˆ‘å€‘æœ‰æåˆ° block formatting context, inline formatting contextï¼Œé‚£é€™äº›ç©¶ç«Ÿæ˜¯ä»€éº¼å‘¢ï¼Ÿ

CSS è¦ç¯„ä¸­ä¸¦æ²’æœ‰çµ¦ formatting context ä¸€å€‹å…·é«”çš„æè¿°ï¼Œæˆ‘æ˜¯å°‡ formatting context ç†è§£æˆ **group** çš„æ¦‚å¿µï¼Œå‡è¨­åœ¨ flow layout ä¸‹ï¼ŒæŸå€‹ block element å‰µé€ äº†ä¸€å€‹ block formatting contextï¼Œé‚£éº¼ç¾åœ¨æ•´ä»½ document è£¡å°±å­˜åœ¨äº†ä¸€å€‹ id ç‚º 123 (å‡è¨­) çš„ block formatting contextï¼Œä½ å¯ä»¥æŠŠä»»ä½• element åŠ åˆ°é€™å€‹ id ç‚º 123 çš„ block formatting contextï¼Œè€Œé€™äº› elements å°±è¢«è¦–ç‚ºå­˜åœ¨åœ¨åŒä¸€å€‹ context ä¹‹ä¸‹ã€‚

ç•¶ç„¶é€™äº› element ä¹Ÿå¯ä»¥è‡ªç«‹é–€æˆ¶ï¼Œåœ¨å…¶ä¸‹è‡ªå‰µæ–°çš„ block formatting contextï¼Œé‚£é€™å€‹ block formatting context çš„ id å°±æœƒèˆ‡å‰›é–‹å§‹é‚£å€‹ block element å‰µçš„ä¸åŒã€‚

å› æ­¤ï¼Œä¸€ä»½ document è£¡å¯ä»¥æœ‰å¤šç¨® formatting context ï¼Œè€Œæ¯ç¨® formatting context åˆå¯ä»¥æœ‰å¤šä»½ä¸åŒ id çš„ contextã€‚

ä¸åŒçš„ formatting context éµå¾ªè‘—ä¸åŒçš„æ’åˆ—æ–¹å¼ï¼Œåƒæ˜¯ block formatting context éµå¾ª block æ’åˆ—ã€inline formatting context éµå¾ª inline æ’åˆ—ã€‚è€Œ formatting context èˆ‡ formatting context å½¼æ­¤é–“ä¹Ÿå­˜åœ¨ä¸€äº›äº’å‹•è¦å‰‡ï¼Œåƒæ˜¯ä¸åŒçš„ block formatting context å½¼æ­¤é–“ä¸æœƒç™¼ç”Ÿ margin collapse:

```html
<div>
  <p>Line 1</p>
  <p>Line 2</p>
  <div class="newBFC">
    <p>Line 3</p>
  </div>
</div>

<style>
  p {
    margin: 20px 0;
  }
</style>

<!--å¦‚æœ .newBFC å‰µé€ äº†ä¸€å€‹æ–°çš„ block formmating contextï¼Œé‚£éº¼ Line 2 èˆ‡ Line 3 é–“å°±ä¸æœƒç™¼ç”Ÿ margin collapse-->
```

æ›´å¤šé—œæ–¼ block formatting context çš„ç”¢ç”Ÿæ™‚æ©Ÿã€è¡Œç‚ºèˆ‡æ‡‰ç”¨æˆ‘æœƒå¦å¯«ä¸€ç¯‡æ–‡ç« åšä»‹ç´¹ã€‚

ç›´è‡³ç›®å‰ç‚ºæ­¢ï¼Œæœ‰å‡ºç¾åœ¨ CSS è¦ç¯„è£¡ä¸¦è¢«ç‰¹åˆ¥å®šç¾©çš„ formatting context ç¨®é¡åªæœ‰ block formatting contextã€inline formatting contextã€flex formatting context èˆ‡ grid formatting contextã€‚

## ç‚ºä»€éº¼ Layout Mode é‡è¦

å‰é¢æˆ‘å€‘è¬›äº†è¨±å¤š layout mode èˆ‡ formatting context çš„å®šç¾©ï¼Œä½ ä¸€å®šæƒ³å•ï¼Œé€™äº›æ±è¥¿ç‚ºä½•é‡è¦ï¼Ÿç‚ºä½•æœƒæ”¹è®Šæˆ‘çœ‹å¾… CSS çš„èªçŸ¥å‘¢ï¼Ÿ

é‚£æ˜¯å› ç‚º**ä¸åŒçš„ CSS å±¬æ€§æœƒå› ç‚ºèº«è™•çš„ layout mode ä¸åŒï¼Œè€Œæœ‰ä¸åŒçš„è¡Œç‚º**ã€‚

èˆ‰ `z-index` ç‚ºä¾‹ï¼Œæˆ‘å€‘çŸ¥é“ `z-index` å€¼æ„ˆé«˜çš„ element æœƒè¢«æ“ºåœ¨æ„ˆä¸Šé¢ (z è»¸)ï¼Œä½†ç¥å¥‡çš„æ˜¯ï¼Œ**`z-index` åœ¨ flow layout ä¸‹æ˜¯æ²’æœ‰ä½œç”¨çš„**ï¼å¦‚æœä½ ä¸çŸ¥é“ layout mode çš„æ¦‚å¿µï¼Œä½ å°±ä¸æœƒçŸ¥é“ bug åœ¨å“ªã€‚å†èˆ‰ `width` ç‚ºä¾‹ï¼Œé€™å€‹å±¬æ€§**åœ¨ flow layout ä¸‹èˆ‡ flexible box layout ä¸‹æœ‰ä¸åŒçš„è¡Œç‚º**ï¼Œåœ¨ flow layout ä¸‹ï¼Œ`width` ä»£è¡¨ element çš„å¯¬åº¦ï¼Œä½†åœ¨ flexible box layout ä¸‹ï¼Œ`width` ä»£è¡¨ element çš„ **hypothetical size**ï¼Œæœƒå—åˆ° `flex-grow` èˆ‡ `flex-shrink` å½±éŸ¿ï¼Œå¦‚æœä½ ä¸çŸ¥é“ layout mode çš„æ¦‚å¿µï¼Œä½ å°±æœƒå¾ˆç–‘æƒ‘ç‚ºä»€éº¼ç„¡è«– width è¨­å¤šå°‘ï¼Œelement å¯¬åº¦éƒ½ä¸æœƒè®Šã€‚

ç€è¦½å™¨æ¸²æŸ“ç•«é¢çš„éç¨‹å°±åƒæ˜¯ä¸€æ¢æ–¹ç¨‹å¼ï¼Œä½ çµ¦äºˆ input (CSS å±¬æ€§ç­‰) å°±æœƒç”¢å‡ºå°æ‡‰çš„ output (ç•«é¢)ã€‚è€Œ input é™¤äº†æœ‰ CSS å±¬æ€§å¤–ï¼Œé‚„æœ‰ç•¶å‰çš„ layout modeï¼Œå¦‚æœä½ å¿½ç•¥äº† layout modeï¼Œé‚£éº¼ç†æ‰€ç•¶ç„¶ä½ æœƒå° output å……æ»¿ç–‘æƒ‘ï¼Œä¸è§£ç‚ºä½•åŒæ¨£çš„å±¬æ€§å»ç”¢å‡ºä¸ä¸€æ¨£çš„ç•«é¢ã€‚

èªçŸ¥ layout mode å¯ä»¥è£œè¶³æˆ‘å€‘ mental model ç¼ºå¤±çš„é‚£å¡Šï¼Œä¸¦è®“æˆ‘å€‘å¯«èµ· CSS æ›´è‡ªä¿¡ã€‚

## å¦‚ä½•æ”¹è®Š Layout Mode

æˆ‘å€‘èƒ½é€é `display` å±¬æ€§èˆ‡ `position` ç­‰å±¬æ€§æ”¹è®Š layout modeã€‚

ç•¶æˆ‘å€‘ç‚ºä¸€å€‹ element åŠ ä¸Š `position` å±¬æ€§æ™‚ï¼Œè©² element å°±æœƒæˆç‚º positioned layout çš„ã€‚

è€Œç•¶æˆ‘å€‘å®šç¾© `display` å±¬æ€§æ™‚ï¼Œäº‹æƒ…æœƒè®Šå¾—ç¨å¾®è¤‡é›œä¸€é»ï¼Œè©² `display` å±¬æ€§ **æœƒåŒæ™‚ç”¢ç”Ÿ outer display style èˆ‡ inner display style**ï¼Œouter display style ä½œç”¨åœ¨è¢«æ¨™ä¸Š display å±¬æ€§çš„é‚£å€‹ element ä¸Šï¼Œè€Œ inner display style å‰‡ä½œç”¨åœ¨é‚£å€‹ element çš„ children ä¸Šã€‚

ä¸åŒçš„ display style æœƒå°æ‡‰ç”¢ç”Ÿä¸åŒçš„è¡Œç‚ºï¼Œåº•ä¸‹é€™å¼µ table èªªæ˜ç•¶ä½ ä½¿ç”¨ display å±¬æ€§æ™‚ï¼ŒèƒŒå¾Œåšäº†ä»€éº¼äº‹ï¼š

![Display table](https://res.cloudinary.com/dgppby8lr/image/upload/v1641712344/display-table_ykm5qt.png)

å¾ä¸Šé¢é€™å¼µ table å¯ä»¥çœ‹åˆ°ï¼Œç•¶ä½ å¯«å‡º `display: block` æ™‚ï¼Œä½ å…¶å¯¦æ˜¯å¯«å‡ºäº† `display: block flow`ï¼Œå‰é¢çš„ `block` æ˜¯ outer display styleï¼Œä»£è¡¨è©² element æœƒæ˜¯ä¸€å€‹ block elementï¼Œè€Œå¦‚æˆ‘å€‘å‰é¢æ‰€èªªï¼Œå¦‚æœä»–å‰›å¥½åˆåœ¨ flow layout ä¸‹ï¼Œé‚£éº¼è©² element å°±æœƒåƒèˆ‡åˆ°ä¸€å€‹ block formatting context ä¹‹ä¸­ï¼Œä¸¦ä¾ç…§ block çš„æ–¹å‘é€²è¡Œæ’åˆ—ã€‚å¾Œé¢çš„ `flow` æ˜¯ inner display styleï¼Œä»£è¡¨è©² element æœƒç”¨ flow layout å°åº•ä¸‹çš„ children é€²è¡Œæ’åˆ—ã€‚

æˆ‘å€‘çŸ¥é“æ¯å€‹ element éƒ½æœ‰ display å±¬æ€§ï¼Œå› æ­¤ä¸Šé¢é€™å€‹éç¨‹æœƒæŒçºŒçš„éè¿´ä¸‹å»ï¼Œæœ€å¾Œæ¯å€‹ element å°±æœƒæ­£ç¢ºçš„è¢«å®šä½ï¼Œä¹Ÿå°±æœƒå‘ˆç¾å‡ºä¸€ä»½æ¼‚äº®çš„ç¶²é ã€‚

ä¸‹é¢èˆ‰ä¸€å€‹ä¾‹å­ï¼Œå‡è¨­æˆ‘å€‘æœ‰ä¸‹é¢é€™æ¨£çš„ htmlï¼š

```html
<div>
  <div class="a" style="display: flex">
    <div class="b" style="display: block">123</div>
  </div>
</div>
```

é‚£éº¼åœ¨å…§éƒ¨ä»–æœƒè¢«çœ‹ä½œé€™æ¨£ï¼š

```
(flow layout)
.a æ˜¯ block-level elementï¼Œå› ç‚ºåœ¨ flow layout ä¸‹ï¼Œæ‰€ä»¥åƒèˆ‡ block formatting contextã€‚ä¸¦åœ¨å…¶ä¸‹å‰µå»º flexible box layout
|
| (flexible box layout)
| .b æ˜¯ block level elementï¼Œä½†å› ç‚ºåœ¨ flexible box layout ä¸‹ï¼Œæ‰€ä»¥æ”¹ç‚ºåƒèˆ‡ flex formatting contextã€‚ä¸¦åœ¨å…¶ä¸‹å‰µå»º flow layout
```

## ç¸½çµ

é€™ç¯‡æ–‡ç« å¾ CSS è¦ç¯„çš„è§’åº¦ä¾†è§£é‡‹ç¶²é  element çš„æ’åˆ—åŸç†ï¼Œå¯ä»¥èªªæ˜¯æœ€æ ¹æœ¬çš„ CSS çŸ¥è­˜ã€‚

å¾é€™å€‹çŸ¥è­˜å‡ºç™¼ï¼Œä½ å°±èƒ½äº†è§£ç‚ºä»€éº¼å¯« CSS æ™‚å¸¸æœƒæœ‰ä¸å¯é æœŸçš„è¡Œç‚ºã€‚åœ¨æœªä¾†ï¼Œæˆ‘ä¹Ÿæœƒå¾æ­¤è™•å‡ºç™¼ï¼Œè§£é‡‹æ›´å¤šçš„ CSS trick åŠç•°å¸¸ä¹‹è™• (è§£é‡‹ä¹‹å¾Œä½ æœƒç™¼ç¾é€™äº›ä¸€é»éƒ½ä¸ç•°å¸¸ï¼Œéƒ½æ˜¯ç…§è‘—è¦ç¯„èµ°è€Œå·² ğŸ˜…)ã€‚

<RefsSection>
  <Ref
    text="CSS Flow Layout - CSS: Cascading Style Sheets | MDN"
    link="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flow_Layout"
  />
  <Ref
    text="Layout mode - CSS: Cascading Style Sheets | MDN"
    link="https://developer.mozilla.org/en-US/docs/Web/CSS/Layout_mode"
  />
  <Ref
    text="Visual formatting model #normal-flow"
    link="https://www.w3.org/TR/CSS2/visuren.html#normal-flow"
  />
  <Ref
    text="Box Layout Modes: the display property"
    link="https://drafts.csswg.org/css-display/#the-display-properties"
  />
  <Ref
    text="Introduction to formatting contexts - CSS: Cascading Style Sheets | MDN"
    link="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flow_Layout/Intro_to_formatting_contexts"
  />
</RefsSection>
